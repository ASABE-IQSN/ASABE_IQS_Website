{% extends "base.html" %}
{% load static %}
{% block title %}Live Results â€“ {{ event.event_name|default:"IQS Live" }}{% endblock %}

{% block extra_head %}
  <link rel="stylesheet" href="{% static 'live/css/live_pull.css' %}?1">
{% endblock %}

{% block content %}

<script>
  window.IQS = {
    apiUrl: "{{ api_url }}",
  };
</script>


<script defer src="{% static 'live/js/live_pull.js' %}"></script>



<div class="live-page">
  <header>
    <h1>
      Live Pull
    </h1>

    <!-- <div class="pull-meta">
      Team: <strong><span data-field="team_name">TEAM</span></strong> <span data-field="team_number">NUMBER</span><br>
      Distance: <span data-field="distance">0</span> ft<br>
      Hook : <span data-field="hook_name">HOOK</span>
    </div> -->

  </header>
  <section class="panel panel-video">
  <div class="panel-head">
    <h2 class="panel-title">Live Stream</h2>
    <div class="chip chip-live">STREAM</div>
  </div>

  <div class="video-wrap">
    <iframe
      src="https://www.youtube.com/embed/X6kVYh22shk?autoplay=1&mute=1&rel=0&modestbranding=1"
      title="Live Pull Stream"
      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
      referrerpolicy="strict-origin-when-cross-origin"
      allowfullscreen>
    </iframe>
  </div>
</section>

 <div class="panel panel-current">
  <div class="panel-head">
    <h2 class="panel-title">Current Pull</h2>
    <div class="chip chip-live" id="sseStatus">LIVE</div>
  </div>

  <div class="current-grid">
    <!-- left side: metadata -->
    <div class="current-meta">
      <div>
        <span class="k">Team</span>
        <strong><span data-field="team_name">TEAM</span></strong>
        <span class="muted">#<span data-field="team_number">NUMBER</span></span>
      </div>
      <div><span class="k">Hook</span> <strong><span data-field="hook_name">HOOK</span></strong></div>
      <div><span class="k">Tractor</span> <strong><span data-field="tractor_name">None</span></strong></div>
    </div>

    <!-- right side: live numbers -->
    <div class="current-live">
      <div class="live-stat">
        <div class="live-label">Distance</div>
        <div class="live-value"><span data-field="distance">0</span> <span class="live-unit">ft</span></div>
      </div>

      <div class="live-stat">
        <div class="live-label">Speed</div>
        <div class="live-value"><span data-field="speed">0</span> <span class="live-unit">mph</span></div>
      </div>

      <div class="live-stat">
        <div class="live-label">Force</div>
        <div class="live-value"><span data-field="force">0</span> <span class="live-unit">lbf</span></div>
      </div>
    </div>
  </div>
</div>


  <div class="grid">
  <section class="panel panel-chart">
    <canvas id="liveChart" height="300"></canvas>
  </section>

  <aside class="panel panel-board">
    <div class="panel-head">
      <div>
        <h2 class="panel-title">Hook Leaderboard</h2>
        <div class="panel-subtitle">
          Live standings for this hook
        </div>
      </div>
      <div class="chip" id="boardCount">0</div>
    </div>

    <div id="leaderboard" class="leaderboard">
      <div class="empty" id="boardEmpty">No standings yet.</div>
    </div>
  </aside>
</div>


<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

{% endblock %}
