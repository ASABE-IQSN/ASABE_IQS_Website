{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>{% block title %}International Quarter Scale{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: #020617;
      color: #f3f6e7;
    }
    a { color: #6687fc; text-decoration: none; }
    a:hover { text-decoration: underline; }

    .page {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .site-logo {
      max-height: 80px;
      max-width: 120%;
      height: auto;
      width: auto;
    }

    .asabe-logo {
      max-height: 40px;
      max-width: 120%;
      height: auto;
      width: auto;
    }

    header {
      padding: 1rem 1.5rem;
      border-bottom: 1px solid #111827;
      background: #020617;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      font-weight: 700;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      font-size: 0.9rem;
      color: #9ca3af;
    }

    .nav-links a {
      margin-left: 1rem;
      font-size: 1.0rem;
      color: #9ca3af;
      flex: 1;                /* ← this is the key */
      text-align: center;
      padding: 0.75rem 0.5rem;
      font-weight: 500;
      text-decoration: none;
      transition: background 0.15s ease;
      align-items: flex-start;
    }

    .nav-links a.active {
      color: #e5e7eb;
      font-weight: 600;
    }

    main {
      flex: 1;
      padding: 1.5rem;
    }

    .wrap {
      max-width: 1000px;
      margin: 0 auto;
    }

    .empty {
      font-size: 0.9rem;
      color: #9ca3af;
    }

    footer {
      padding: 1rem 1.5rem;
      border-top: 1px solid #111827;
      font-size: 0.8rem;
      color: #6b7280;
      display: flex;
      gap: 10px;
      justify-content: center;
      align-items: center;
      text-align: center;
    }

    .announcement-card {
      max-width: 900px;
      margin: 0 auto 1.5rem;
      padding: 1rem 1.25rem;
      border-radius: 1rem;
      background: linear-gradient(135deg, #020617, #020617) padding-box,
                  linear-gradient(135deg, #6687FC, #0ea5e9) border-box;
      border: 1px solid transparent;
      display: flex;
      gap: 1rem;
      align-items: center;
      justify-content: space-between;
    }

    .announcement-text {
      font-size: 0.95rem;
      color: #F3F6E7;
      line-height: 1.4;
    }

  .announcement-actions {
    display: flex;
    gap: 0.5rem;
    flex-shrink: 0;
  }

    {% block extra_styles %}{% endblock %}
  </style>

  {% block extra_head %}{% endblock %}
</head>
<body>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Y1M9QRZMRZ"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-Y1M9QRZMRZ');
    </script>

<div class="page">
  <header>
    <!-- <div class="logo">International Quarter Scale</div> -->
    <a href="https://asabe.org/iqs">
      <img
        src="{% static 'events/images/ASABE-IQS-logo-white.png' %}"
        alt="International Quarter Scale"
        class="site-logo"
        >
     </a>
    <nav class="nav-links">
      <a href="{% url 'events:landing' %}"
         class="{% if active_page == 'landing' %}active{% endif %}">
        Home
      </a>
      <a href="{% url 'events:event_list' %}"
         class="{% if active_page == 'events' %}active{% endif %}">
        Events
      </a>
      <a href="{% url 'events:team_list' %}"
         class="{% if active_page == 'teams' %}active{% endif %}">
        Teams
      </a>
      <a href="{% url 'events:tractor_list' %}"
         class="{% if active_page == 'tractors' %}active{% endif %}">
        Tractors
      </a>

      
      <!-- {% if user.is_authenticated %}
      <a href="{% url 'users:account' %}">My Account</a>
        <form action="{% url 'logout' %}" method="post" style="display:inline;">
          {% csrf_token %}
          <button type="submit" class="logout-button">Logout</button>
        </form>
    {% else %}
      <a href="{% url 'login' %}">Login</a>
    {% endif %} -->

    <span id="auth-slot" style="display:none;"></span>
    </nav>
  </header>

  <main>
    <div class="wrap">
      {% block content %}{% endblock %}
    </div>
  </main>

  <footer>
    <a href="https://asabe.org/">
      <img
        src="{% static 'events/images/ASABE_Logo_White.png' %}"
        alt="ASABE"
        class="asabe-logo"
      >
    </a>
    
    &copy; 2026 International Quarter Scale Competition •
    <a href="{% url 'events:privacy' %}">Privacy Policy</a>
  </footer>
</div>

{% block extra_scripts %}{% endblock %}
</body>
</html>

<script>
(async function () {
  const slot = document.getElementById("auth-slot");
  if (!slot) return;

  try {
    const r = await fetch("{% url 'users:auth_status' %}", { credentials: "same-origin" });
    const data = await r.json();

    if (data.authenticated) {
      slot.innerHTML = `
        <a href="${data.accountUrl}"class="{% if active_page == 'my account' %}active{% endif %}">My Account
           </a>
        <form action="${data.logoutUrl}" method="post" style="display:inline;">
          <input type="hidden" name="csrfmiddlewaretoken" value="${data.csrfToken}">
          <button type="submit" class="logout-button">Logout</button>
        </form>
      `;
    } else {
      slot.innerHTML = `<a href="${data.loginUrl}">Login</a>`;
    }

    slot.style.display = "inline";
  } catch (e) {
    // Fail gracefully: show Login if the check fails
    slot.innerHTML = `<a href="{% url 'login' %}">Login</a>`;
    slot.style.display = "inline";
  }
})();
</script>