{% extends "base.html" %}

{% block title %}Maneuverability Run â€“ {{ maneuverability_run.team.team_name }}{% endblock %}

{% block extra_styles %}
  .man-page-header {
    margin-bottom: 1.5rem;
  }

  .man-page-header h1 {
    margin: 0 0 0.25rem;
  }

  .man-meta {
    font-size: 0.9rem;
    color: #9ca3af;
    margin-bottom: 1rem;
  }
{% endblock %}

{% block content %}
  <header class="man-page-header">
    <h1>Maneuverability Run</h1>
    <div class="man-meta">
      Team: <strong>{{ maneuverability_run.team.team_name }}</strong> ({{ maneuverability_run.team.team_number }})<br>
      Event: {{ maneuverability_run.event.event_name|default:maneuverability_run.event_id }}<br>
      Run Order: {{ maneuverability_run.run_order }}<br>
      State: {{ maneuverability_run.state }}<br>
      Updated: {{ maneuverability_run.updated_at }} ({{ maneuverability_run.updated_by_source }})
    </div>
  </header>

  {% for vid in yt_embed %}
    <iframe
      width="1000"
      height="500"
      src="https://www.youtube.com/embed/{{ vid.link }}"
      title="YouTube video player"
      frameborder="0"
      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
      referrerpolicy="strict-origin-when-cross-origin"
      allowfullscreen>
    </iframe>
  {% endfor %}

  {% if photos %}
  <section style="background: #0f172a; border-radius: 0.75rem; padding: 1rem; box-shadow: 0 10px 30px rgba(15,23,42,0.8); margin-bottom: 1.25rem;">
    <h2 style="margin-top: 0; margin-bottom: 0.75rem; font-size: 1.1rem;">Photos</h2>
    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 1rem;">
      {% for photo in photos %}
        <div style="border: 1px solid #1f2937; border-radius: 0.5rem; overflow: hidden; background: #020617;">
          <img src="/static/{{ photo.link }}" alt="{{ photo.caption|default:'Maneuverability photo' }}" style="width: 100%; height: 200px; object-fit: cover; display: block;">
          {% if photo.caption %}
            <div style="padding: 0.5rem 0.75rem; font-size: 0.85rem; color: #9ca3af;">{{ photo.caption }}</div>
          {% endif %}
        </div>
      {% endfor %}
    </div>
  </section>
  {% endif %}

  
  <section style="background: #0f172a; border-radius: 0.75rem; padding: 1rem; box-shadow: 0 10px 30px rgba(15,23,42,0.8); margin-bottom: 1.25rem;">
    <h2 style="margin-top: 0; margin-bottom: 0.75rem; font-size: 1.1rem;">Upload Photo</h2>
    <form method="post" action="{% url 'events:upload_maneuverability_photo' maneuverability_run.maneuverability_run_id %}" enctype="multipart/form-data">
      {% csrf_token %}
      <div style="display: grid; gap: 0.75rem;">
        <div>
          <input type="file" name="photo" accept="image/*"
                 style="padding: 0.4rem; border: 1px solid #1f2937; border-radius: 0.5rem; background: #020617; color: #F3F6E7; font-size: 0.9rem; width: 100%;">
        </div>
        <div>
          <label style="font-size: 0.85rem; color: #9ca3af; margin-bottom: 0.25rem; display: block;">Caption (optional)</label>
          <input type="text" name="photo_caption" maxlength="255" placeholder="Add a caption for this photo..."
                 style="padding: 0.4rem 0.75rem; border: 1px solid #1f2937; border-radius: 0.5rem; background: #020617; color: #F3F6E7; font-size: 0.85rem; width: 100%;">
        </div>
        <div style="font-size: 0.8rem; color: #9ca3af;">Supported formats: PNG, JPG, JPEG, GIF, WebP.</div>
        <div>
          <button type="submit"
                  style="padding: 0.45rem 1rem; border-radius: 999px; border: 1px solid #1f2937; background: #22c55e; color: #020617; cursor: pointer;">
            Upload
          </button>
        </div>
      </div>
    </form>
  </section>
  

  {% if not yt_embed and not photos %}
    <p>No media available for this run.</p>
  {% endif %}
{% endblock %}
